# API JSON Objects
PayFabric uses JSON objects to send and receive client data. This is the official reference documentation for JSON objects used in the PayFabric REST API.

## Address
Address objects represent the shipping or billing address of a customer. This object may be included as a child attribute of other JSON objects (such as [Card](#card)).

| Attribute  | Data Type| Definition|Max Length|
| :-----------|:---------| :---------| :---------|
| ID         | Guid | Unique identifier for this record |36|
| Customer   | String | ID for this customer. This is generated by the client upon creation of the customer. |nvarchar(128)|
| Country    | String | Country name. Must be ISO A3 code if merchant enable Fraud.|varchar(64)|
| State      | String | State name. Must be ISO A2 code if merchant enable Fraud.| varchar(64)| 
| City       | String | City name |varchar(64)|
| Line1      | String | Street line 1 |nvarchar(128)|
| Line2      | String | Street line 2 |nvarchar(128)|
| Line3      | String | Street line 3 |nvarchar(128)|
| Email      | String | Email address|nvarchar(128)|
| Phone      | String | Phone number |varchar(16)|
| Zip        | String | Zip code |varchar(16)|
| ModifiedOn | String | This field indicates the current address last modified date time in merchant [Timezone](https://github.com/PayFabric/Portal/blob/master/PayFabric/Sections/Timezone.md). It's format should like "3/23/2015 11:16:19 PM".|datetime,not null|
| ModifiedOnUTC | String | This field indicates the current address last modified date time in UTC. It's format should like "2021-10-19T05:12:13.000Z".|datetime,not null|


## CardHolder
The cardholder object represents the owner of a credit card or eCheck. This object is always included as a child object of the Card object.

PayFabric encrypts the attributes "DriverLicense" and "SSN" before storing them.

| Attribute  | Data Type| Definition|Max Length|
| :-----------|:---------| :---------|:---------|
| DriverLicense   | String | Driver license  | varchar(32)|
| FirstName      | String | First name |nvarchar(64)|
| LastName       | String | Last name| nvarchar(64)| 
| MiddleName      | String | Middle name|nvarchar(64)|  
| SSN             | String | Social security number| varchar(16)| 

\* Required

## Card
The Card object represents a Credit Card or eCheck of a customer.

| Attribute  | DataType  | Definition|Max Length|
| :-----------------|:-------------| :---------| :---------|
| ID              | Guid | Unique identifier for a card or wallet record. This ID (aka Wallet ID) is generated by PayFabric upon successful creation of a new card entry for either credit card or ACH. The client cannot set or modify this value.  | 
| Tender*          | Options | Tender type. Valid options are ``CreditCard``, ``ECheck``, `ApplePay` and `GooglePay`. |nvarchar(64)|
| Customer*        | String | Customer ID or Customer Number as specified by the client upon creation of the customer. This is a required field in order to associate a card/wallet entry to a customer account. | nvarchar(128)|  
| Account*         | String | The number of the gift card, credit card, or the eCheck/ACH account. When creating a new Card this attribute must be provided by the client in plaintext. When a client retrieves a card, PayFabric always returns this attribute in masked format. Ignore this attribute when update a existing card. |nvarchar(64)|  
| ExpDate*         | String | Expiration date of the credit card in the format of MMYY. Only valid for credit cards. | varchar(4)| 
| CheckNumber     | String | Check number. Only valid for eChecks, and required for specific Processors (TeleCheck, Encompass). | varchar(128)| 
| AccountType     | String | eCheck account type. Only valid for eCheck accounts. | varchar(32)| 
| Aba*             | String | Bank Routing Number. Only valid for eChecks. | varchar(64)| 
| CardName        | String | Type of credit card: ``Visa``, ``Mastercard``, ``Discover``,``JCB``,``AmericanExpress``,``DinersClub``. Only valid for credit cards. | nvarchar(16)|
| IsDefaultCard   | Boolean | Indicates whether this is the primary card of the customer. Default value is ``False``. | bit, not null| 
| IsLocked        | Boolean | Indicates whether the card is locked. Default value is ``False``.| bit, null |
| IsSaveCard      | Boolean | Indicates whether to save this card in the customer's wallet. If set this field as true, PayFabric will check the existence for the new wallet, if existing, return the existing wallet ID, assign it the new wallet object, then do the update wallet workflow if the transaction approved. This attribute is only valid and should only be included in the object when using [Create a Transaction](Transactions.md#create-a-transaction) and [Create and Process a Transaction](Transactions.md#create-and-process-a-transaction). And it will be set to false automatically for _Verify_ transactions or transactions with Tender set to `ApplePay` or `GooglePay`.|  
| ModifiedOn      | string | This is a response field. It indicates the current wallet last modified date time in merchant [Timezone](https://github.com/PayFabric/Portal/blob/master/PayFabric/Sections/Timezone.md). It's format should like "3/23/2015 11:16:19 PM". | datetime, not null| 
|ModifiedOnUTC|String|This is a response field. It indicates the current wallet last modified date time in UTC. It's format should like "2021-03-30T07:22:28.206Z". | datetime, not null|
| CardHolder      | [Object](#cardholder) | Cardholder object. |  
| Billto          | [Object](#address) | Address object. | 
| Identifier      | String | A client-defined identifier for this card. Developer can send a flag value to identify this card |  nvarchar(32)|
| UserDefine1    | String | User-defined field 1. Developer can store additional data in this field. |nvarchar(256)|  
| UserDefine2    | String | User-defined field 2. Developer can store additional data in this field. | nvarchar(256)| 
| UserDefine3    | String | User-defined field 3. Developer can store additional data in this field. |  nvarchar(256)|
| UserDefine4    | String | User-defined field 4. Developer can store additional data in this field. | nvarchar(256)|
| Connector       | String | The gateway name defined by PayFabric such as FirstDataGGe4, PayflowPro or Paymentech. This field will be set only if this card is a tokenized value for a specific gateway, such as FirstData or Paypal|nvarchar(64)|
| GatewayToken    | String | Gateway token. PayFabric send this value to gateway for processing a transaction|varchar(32)|
| IssueNumber     | String | This field is required for UK debit cards|nvarchar(64)|
| StartDate       | String | This field is required for UK debit cards, format is MMYY.|varchar(4)|
| NewCustomerNumber | String | This field is used to submit new customer number for updating this record's customer field. | nvarchar(128)|  
| CardType | String | This is a response field, the possible value is 'Credit', 'Debit' or 'Prepaid' for credit card, and it is blank for eCheck. | varchar(20)| 
| EncryptedToken    | String | The Apple Pay or Google Pay payment token, as provided by the provider.  Conditionally required if Tender is `ApplePay` or `GooglePay`. | nvarchar(MAX)|
| LastUsedDate      | string | This is a response field. It indicates the current wallet last used date time in merchant [Timezone](https://github.com/PayFabric/Portal/blob/master/PayFabric/Sections/Timezone.md). It's format should like "3/23/2015 11:16:19 PM". | datetime, not null| 
|LastUsedDateUTC|String|This is a response field. It indicates the current wallet last used date time in UTC. It's format should like "2021-03-30T07:22:28.206Z". | datetime, not null|
|CardHolderAccountInfo|[Object](#cardholderaccountinfo)|This is an optional object to create wallet, provide ability for merchant to submit additional card holder account info when merchant enables Fraud and enables credit card validation.|
|TrxInitiation|string|This field specifies who initiates the wallet creation/updating, available values are 'Merchant' and 'Customer'. |nvarchar(10)|

\* Required

## Transaction Response
PayFabric returns the Transaction Response object as the result of most operations related to transactions. Most of the attributes of the object are forwarded from the Payment Gateway's response to the transaction.

| Attribute  | DataType| Definition|Max Length|
| :-----------|:---------| :---------| :---------|
| TrxKey               | String | PayFabric transaction key. This is generated upon creation of the transaction in the PayFabric server. |varchar(64)| 
| AuthCode             | String | Authorization code. Generated by the Payment Gateway. |varchar(64)| 
| Status               | String | Status of transaction. Generated by the Payment Gateway. Possible values are ``Approved``, ``Denied``, ``Declined``, ``Failure``, ``AVSFailure``,  ``MoreInfo`` and ``FraudReject``. | varchar(16)| 
| ResultCode           | String | Result code of the transaction. Generated by the Payment Gateway. |varchar(32)| 
| Message              | String | Result message of the transaction. Generated by the Payment Gateway. | nvarchar(512)|  
| OriginationID        | String | Unique identifier for the transaction. Generated by the Payment Gateway. | varchar(128)| 
| TrxDate              | String | Date of transaction. It's format should like "3/23/2015 11:16:19 PM". | datetime| 
| RespTrxTag           | String | A tag value which is generated by FirstData, which must be included when submitting a transaction to FirstData. This is only valid if FirstData GGe4 is the Payment Gateway. |  varchar(32)|
| CVV2Response         | String | Verification status code of CVC code. Generated by the Payment Gateway. |nvarchar(32)|  
| AVSZipResponse       | String | Verification status code of zip code. Generated by the Payment Gateway. | nvarchar(32)| 
| AVSAddressResponse   | String | Verification status code of billing address. Generated by the Payment Gateway.|nvarchar(32)|  
| IAVSAddressResponse  | String | Flag indicating that address verification has been ignored because the address is an international address. Generated by the Payment Gateway. | nvarchar(32)|
|TrxAmount|String| Transaction amount without surcharge amount. This field is for backward compatibility.||
|OrigTrxAmount|String| Transaction amount without surcharge amount.||
|SurchargeAmount|string|Transaction surcharge amount, surcharge amount = OrigTrxAmount * SurchargePercentage ||
|SurchargePercentage|string|Surcharge percentage configured for the gateway which the transaction processed with.||
|FinalAmount|string|This is the amount current transaction really captured, FinalAmount = OrigTrxAmount + SurchargeAmount.||
|RemainingBalance|string|This field is only for gift card transctions, indicats the remaining balance of the gift card.||
|WalletID|GUID|The wallet ID for the processed transaction.||
|ExpectedSettledTime|Date time| This field indicates the expected settled time in merchant [Timezone](https://github.com/PayFabric/Portal/blob/master/PayFabric/Sections/Timezone.md). ||
|ExpectedSettledTimeUTC|Date time| This field indicates the expected settled time in UTC. ||
|SettledTime|Date time| This field indicates the current transaction's settled time in merchant [Timezone](https://github.com/PayFabric/Portal/blob/master/PayFabric/Sections/Timezone.md). ||
|SettledTimeUTC|Date time| This field indicates the current transaction's settled time in UTC. ||
|FraudScore|string| This is the score for fraud check. ||
|ExoneratingText|string| Additional message for exonerating scenario after fraud check. ||
|IncriminatingText|string| Additional message for incriminating scenario after fraud check. ||

>The field `FraudScore`, `ExoneratingText` and `IncriminatingText` only returned when the transaction was submitted for fraud check.

## STO
Simple Transaction Object. This is a lightweight object that only includes the required fields for retrieving a transaction object. 

| Attribute       | DataType| Definition|Max Length|
| :-----------    |:---------| :---------| :---------| 
| Key             | String | PayFabric transaction key. This is generated by PayFabric upon creation of the transaction.  | varchar(64)|
| OriginationID   | String | Unique identifier of the transaction. Generated by the Payment Gateway. |varchar(64)|
| Status          | String | Status message indicating the status of the transaction. Possible values are ``Approved``, ``Denied``, ``Declined``, ``Failure``, ``AVSFailure``, ``More Info``. |varchar(16)|  
| TrxDate         | String | Transaction date. It's format should like "3/23/2015 11:16:19 PM". | datetime| 
| Type            | String | Transaction type. The possible values are ``Sale``,``Book``,``Ship``,``Void``,``Credit``,``Force``. | nvarchar(64)|

## Document
The Document object is used to represent additional invoice, order, or other Level 2/3 information. Some Payment Gateways require merchants to submit these transaction fields when processing transactions. 

| Attribute       | DataType| Definition
| :-----------    |:---------| :---------| 
| Head            | Array | An array of key-value pairs. Usually, the key-value pairs represent the level 2 fields to submit to the gateway.| 
| Lines           | Array | An array of columns object.The columns objects represent the columns that belong to a specific line. Usually the columns objects represent the level 3 fields that you can submit to the gateway. Columns object is an array of key-value pairs. The key-value pairs represent the level 3 fields to submit to the gateway.|
| UserDefined     | String | Up to 50 key value pairs can be stored in this object. Note: Adding `DisableEmailReceipt` under `UserDefined` to disable PayFabric's payment receipt to be sent out for the processed transaction, the possible values are `True` and `False`. If the value is `True`, this will disable the payment receipt to be sent out for the processed transaction. If the value is `False` or empty or the field is not submitted, this will enable the payment receipt to be sent out for the processed transaction based on the configuration of [Payment Receipt](https://github.com/PayFabric/Portal/blob/master/PayFabric/Sections/Payment%20Receipt.md).|
|DefaultBillTo|[Object](#address)| Address object. no restriction to these address fields, partially input is acceptable.|

### Related Reading
* [Level 2 and Level 3 Fields](Level%202%20and%20Level%203%20Fields.md)

## Transaction
The Transaction object represents a single transaction that will pass through PayFabric and be submitted to a Payment Gateway. It is probably the most important and most common object.

| Attribute  | DataType| Definition|Max Length|
| :-----------|:---------| :---------| :---------| 
| Key             | String | PayFabric transaction key. Generated by PayFabric and returned to the client upon creation of the transaction. Omit this field when creating a new transaction.  | varchar(64)|
| Amount*         | Decimal| Transaction amount, only accept 2 decimals. |money|
| Customer       | String | Customer ID or Customer Number as specified by the client upon creation of the customer. NOTE: This is a required field if the wallet entry is saved for later use. |nvarchar(128)|  
| Currency*       | String | Currency code, such as ``USD``. |  varchar(16)|
| Card*  | [Object](#card) | Card object. If you are using an existing card, you only need to specify the ID of the card. If using a new card then all fields are required. |  
| SetupId*        | String | Gateway account profile name. This name is configurable and is defined by the client on the PayFabric web portal. |nvarchar(64)|  
| Tender*         | String | Tender type. Valid values are ``CreditCard``, ``ECheck``. |nvarchar(64)|  
| Type*           | String | Transaction type. Valid values are ``Sale``,``Book``,``Ship``,``Void``,``Credit``, ``Force``.  For more information on PayFabric Transaction Types, click [here](https://github.com/PayFabric/APIs/blob/master/PayFabric/Sections/Transaction%20Types.md). |  nvarchar(64)|
| BatchNumber     | String | Batch number name. For saving this transaction into a PayFabric batch. Merchant can process the batch on PayFabric portal. For _Verify_ transaction type, the value in this attribute will be removed automatically. | varchar(64)| 
| ModifiedOn      | String | Timestamp indicating when this transaction was last modified. It's format should like "3/23/2015 11:16:19 PM". | datetime| 
| Shipto   | [Object](#address)| Address object. |  
| ReqAuthCode          | String | Required for ``Force`` transactions. |varchar(64)|
| ReferenceKey          | String | The transaction key of initial processed transaction, Required for ``Void``, ``Refund`` and ``Capture`` transactions. |varchar(64)|
| ReqTrxTag            | String | Required by FirstData for ``Void``,``Ship`` and reference ``Credit`` transactions. |varchar(64)|
| TrxResponse          | [Object](#transaction-response) | Transaction response from Payment Gateway. |
| Document | [Object](#document) | Level 2/3 transaction fields, as well as User Defined fields. |nvarchar(max)|
| ReferenceTrxs        | Array  | Array of a [Simple Transaction Object](#sto) which represents the original transactions. Value is Set if this transaction is a reference transaction.|
| TrxUserDefine1       | String | User Defined field 1 |nvarchar(256)|
| TrxUserDefine2       | String | User Defined field 2 |nvarchar(256)|
| TrxUserDefine3       | String | User Defined field 3 |nvarchar(256)|
| TrxUserDefine4       | String | User Defined field 4 |nvarchar(256)|
| MSO_EngineGUID       | GUID | GUID of gateway account profile for this transaction. Developer can utilize this field|
| PayDate              | String | A future date to process this transaction. In another word, this transaction won't be processed right away by setting this field. It's format should like "3/23/2015", PayFabric will treat the passed in date in merchant [Timezone](https://github.com/PayFabric/Portal/blob/master/PayFabric/Sections/Timezone.md). For _Verify_ transaction type, the value in this attribute will be removed automatically.|datetime|
| AuthorizationType| String| The authorization type of the transaction, valid values are ``Reauthorization``, ``Resubmission``, ``Incremental`` or ``NotSet`` |varchar(25)|
| TrxSchedule | String| The type authorization of transaction to be processed, valid values are ``Unscheduled``, ``ScheduledInstallment``, ``ScheduledRecurring`` or ``NotSet`` |varchar(25)|
|TrxInitiation| String| The entity that initiated the transaction, valid values are ``Merchant``, ``Customer`` or ``NotSet`` |varchar(25)|
|CCEntryIndicator| String| The identifier that specifies whether the card used on the transaction is a stored credential or newly entered, valid values are ``Entered`` or ``Stored`` |varchar(25)|
|EntryMode|string|This indicate the entry of the transaction processed, like ``API``, ``MRHostedPage``,``Hosted Page`` etc...|
|EntryClass|string|This specifies the SEC (Standard Entry Class) Code of the ACH transaction processed. Acceptable values are: ``TEL``, ``PPD``, ``CCD``, and ``WEB``. This field is not required. It defaults to the DefaultEntryClass setting on the PayFabric Gateway Profile. See [ACH SEC Codes](https://github.com/PayFabric/Portal/blob/master/PayFabric/Sections/SECCodes.md) for more details.|
|CardHolderAccountInfo|[Object](#cardholderaccountinfo)|This is an optional object to process transaction, provide ability for merchant to submit additional card holder account info when merchant enables Fraud.|
| ProcessingMethod         |String| Transaction processing method, This field only available for [Create and Process a Transaction](https://github.com/PayFabric/APIs/blob/R21/PayFabric/Sections/Transactions.md#create-and-process-a-transaction) API, and only required when you want to process a transaction via DiamondCloud terminal, Only available value for this field is 'CardPresent'. ||
| Terminal       | String |This field indicates the DiamondCloud terminal name. It's conditional optional, only required when 'ProcessingMethod = CardPresent'  || 
 
 > The Required fields above only apply to transactions that will be submitted to Payment Gateways. If the transaction is only being saved on the PayFabric server (and not being submitted to a Payment Gateway) then none of the fields are required.
 
 ## CardHolderAccountInfo
| Attribute  | DataType| Definition|Max Length|
| :-----------|:---------| :---------| :---------| 
|AccountAgeIndicator|string|Indicates the length of time that the cardholder has had the account with the Merchant.||2
|AccountChangedIndciator|string|Indicates the length of time since the cardholder’s account information with the Merchant was last changed, including Billing or Shipping address, new payment account, or new user(s) added.|2|
|AccountPasswordChangedIndicator|string|Indicates the length of time since the cardholder’s account with the Merchant had a password change or account reset.|2|
|BrowserDetail|[Object](#BrowserDetail)|Browser Detail Object, this object is auto collected when process transaction in Hosted payment page or in Portal, only accept data when current transaction is processed via API, PayFabric will auto retrieve browser data for those transactions processed in portal, hosted payment page. *Note*: PayLink does not accept this object.|2|
|ConsumerIPAddress|string|IP address of the browser as returned by the HTTP headers to the Merchant.|45|
|CountOfAddCardAttemptsLast24Hours|string|Number of Add Card attempts in the last 24 hours.|3|
|CountOfPurchasesLast6Months|string|Number of purchases with this cardholder account during the previous six months.|4|
|CountOfTransactionsLast12Months|string|Number of transactions (successful and abandoned) for this cardholder account with the Merchant across all payment accounts in the previous year.|3|
|CountOfTransactionsLast24Hours|string|Number of transactions (successful and abandoned) for this cardholder account with the Merchant across all payment accounts in the previous 24 hours.|3|
|DateAccountChanged|string|Date that the cardholder’s account with the Merchant was last changed, including Billing or Shipping address, new payment account, or new user(s) added. Format is like YYYYMMDD. |8|
|DateAccountCreated|string|Date that the cardholder opened the account with the Merchant. Format is like YYYYMMDD.|8|
|DateAccountPasswordChanged|string|Date that cardholder’s account with the Merchant had a password change or account reset. Format is like YYYYMMDD.|8|
|DatePaymentAccountCreated|string|Date that the payment account was enrolled in the cardholder’s account with the Merchant. Format is like YYYYMMDD. |8|
|DateShippingAddressCreated|string|Date when the shipping address used for this transaction was first used with the Merchant. Format is like YYYYMMDD.|8|
|DeviceIdentifier|string|An identifier used to recognize a device uniquely. The content highly depends on availability on the connecting side. Examples could be:Advertising ID, IMEI or unique SDK identifier.|255|
|PaymentAccountAgeIndiciator|string|Indicates the length of time that the payment account was enrolled in the cardholder’s account with the Merchant. |2|
|ShippingAddressUsageIndicator|string|Indicates when the shipping address used for this transaction was first used with the Merchant.|2|
|ShippingNameIndicator|string|Indicates if the Cardholder Name on the account is identical to the shipping Name used for this transaction.|2|
|SuspiciousAccountActivityIndicator|string|Indicates whether the Merchant has experienced suspicious activity (including previous fraud) on the cardholder account.|2|

## BrowserDetail
| Attribute  | DataType| Definition|Max Length|
| :-----------|:---------| :---------| :---------| 
|BrowserAcceptHeader|string|Exact content of the HTTP accept headers as sent to the Merchant from the Cardholder’s browser.|2048|
|BrowserJavaEnabled|Boolean|Boolean that represents the ability of the cardholder browser to execute Java.||
|BrowserJavascriptEnabled|Boolean|Boolean that represents the ability of the cardholder browser to execute JavaScript.||
|BrowserLanguage|string|Value representing the browser language as defined in IETF BCP47.|8|
|BrowserColorDepth|string|Value representing the bit depth of the colour palette for displaying images, in bits per pixel.|2|
|BrowserScreenHeight|string|Total height of the Cardholder’s screen in pixels.|6|
|BrowserScreenWidth|string|Total width of the cardholder’s screen in pixels.|6|
|BrowserTZ|string|Time-zone offset in minutes between UTC and the Cardholder browser local time.|5|
|BrowserUserAgent|string|Exact content of the HTTP user-agent header.|2048|

## Gateway Account Profile
A Gateway Account Profile is the account information of a single Payment Gateway. This is created by the merchant on the PayFabric server via the PayFabric web portal. See [How to Setup Gateway Account](https://github.com/PayFabric/Portal/blob/master/PayFabric/Sections/Gateway%20Configuration.md) for more details.

| Attribute       | DataType| Definition|Max Length|
| :-----------    |:---------| :---------| :---------| 
| ID              | GUID   | Unique identifier for this record, provided by the merchant.  | 
| Name            | String | Gateway account profile name. | nvarchar(64) |
| Connector       | String | PayFabric gateway connector name. | nvarchar(64) | 
| Processor       | String | Bank processor name. | nvarchar(64) |
| ProcessorID     | String | Bank processor ID. | tinyint|
| CardClass       | String | ``Credit`` or ``ECheck``  | nvarchar(64) |
| CardClassID| String| ID of CardClass|tinyint|
|SurchargeRate|Decimal| Surcharge percentage, maximum is 4. ||
|SettledTime|Date time|This field is the last cut off time in merchant [Timezone](https://github.com/PayFabric/Portal/blob/master/PayFabric/Sections/Timezone.md).||
|SettledTimeUTC|Date time|This field is the last cut off time in UTC.||
|DailyBatchCloseTime|Date time|This field is the auto batch close time every day in merchant [Timezone](https://github.com/PayFabric/Portal/blob/master/PayFabric/Sections/Timezone.md).||

## JSON Web Tokens

| Attribute       | DataType| Definition|
| :-----------    |:---------| :---------| 
| Audience              | string   | The `Intent` that this JWT will be used for.  The available values are 'PaymentPage', 'CreateWalletPage', and 'EditWalletPage'. | 
| Subject            | String | The record or entity that the `Intent` will be targeting.<br/><br/>**PaymentPage** expects a Transaction Key created by the Create a Transaction API. <br/><br/>**CreateWalletPage** expects a Customer Name. <br/><br/>**EditWalletPage** expects a Wallet ID. |




